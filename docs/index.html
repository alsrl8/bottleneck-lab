<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bottleneck Lab - ë³‘ëª© ì‹¤ìŠµ í”„ë¡œì íŠ¸</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a0a0b;
            --bg-card: #111113;
            --bg-card-hover: #18181b;
            --border: #27272a;
            --text-primary: #fafafa;
            --text-secondary: #a1a1aa;
            --text-muted: #52525b;
            --accent-red: #ef4444;
            --accent-orange: #f97316;
            --accent-yellow: #eab308;
            --accent-green: #22c55e;
            --accent-blue: #3b82f6;
            --accent-purple: #a855f7;
            --gradient-danger: linear-gradient(135deg, #ef4444 0%, #f97316 100%);
            --gradient-warning: linear-gradient(135deg, #f97316 0%, #eab308 100%);
            --gradient-success: linear-gradient(135deg, #22c55e 0%, #3b82f6 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.7;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 60px 24px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 80px;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -100px;
            left: 50%;
            transform: translateX(-50%);
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(239, 68, 68, 0.08) 0%, transparent 70%);
            pointer-events: none;
        }

        .badge {
            display: inline-block;
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--accent-red);
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            padding: 8px 16px;
            border-radius: 100px;
            margin-bottom: 24px;
        }

        h1 {
            font-size: clamp(48px, 8vw, 72px);
            font-weight: 900;
            letter-spacing: -2px;
            margin-bottom: 16px;
            background: linear-gradient(135deg, #fff 0%, #a1a1aa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Overview Section */
        .overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 80px;
        }

        .overview-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 28px;
            transition: all 0.3s ease;
        }

        .overview-card:hover {
            background: var(--bg-card-hover);
            transform: translateY(-2px);
        }

        .overview-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 16px;
        }

        .overview-card:nth-child(1) .overview-icon { background: rgba(239, 68, 68, 0.15); }
        .overview-card:nth-child(2) .overview-icon { background: rgba(59, 130, 246, 0.15); }
        .overview-card:nth-child(3) .overview-icon { background: rgba(34, 197, 94, 0.15); }

        .overview-card h3 {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .overview-card p {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Phase Section */
        .phase {
            margin-bottom: 60px;
        }

        .phase-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }

        .phase-number {
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            font-weight: 700;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .phase-1 .phase-number { background: var(--gradient-danger); }
        .phase-2 .phase-number { background: var(--gradient-warning); }
        .phase-3 .phase-number { background: var(--gradient-success); }

        .phase-title {
            font-size: 24px;
            font-weight: 700;
        }

        .phase-desc {
            font-size: 14px;
            color: var(--text-secondary);
            margin-left: auto;
        }

        /* Task Cards */
        .tasks {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .task {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .task:hover {
            border-color: #3f3f46;
        }

        .task-header {
            padding: 20px 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .task-checkbox {
            width: 22px;
            height: 22px;
            border: 2px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .task-checkbox:hover {
            border-color: var(--accent-green);
        }

        .task-checkbox.checked {
            background: var(--accent-green);
            border-color: var(--accent-green);
        }

        .task-checkbox.checked::after {
            content: 'âœ“';
            color: white;
            font-size: 14px;
            font-weight: 700;
        }

        .task-info {
            flex: 1;
        }

        .task-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .task-tag {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .tag-db { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }
        .tag-network { background: rgba(168, 85, 247, 0.15); color: var(--accent-purple); }
        .tag-memory { background: rgba(239, 68, 68, 0.15); color: var(--accent-red); }
        .tag-cpu { background: rgba(249, 115, 22, 0.15); color: var(--accent-orange); }
        .tag-infra { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }

        .task-brief {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .task-toggle {
            color: var(--text-muted);
            font-size: 20px;
            transition: transform 0.3s ease;
        }

        .task.expanded .task-toggle {
            transform: rotate(180deg);
        }

        .task-content {
            display: none;
            padding: 0 24px 24px;
            border-top: 1px solid var(--border);
            margin-top: 0;
        }

        .task.expanded .task-content {
            display: block;
            padding-top: 20px;
        }

        .task-section {
            margin-bottom: 20px;
        }

        .task-section:last-child {
            margin-bottom: 0;
        }

        .task-section-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .task-section p, .task-section li {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .task-section ul {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .task-section li::before {
            content: 'â†’';
            color: var(--text-muted);
            margin-right: 8px;
        }

        .code-block {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            overflow-x: auto;
            white-space: pre;
            color: var(--text-secondary);
        }

        /* Progress Bar */
        .progress-section {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border-top: 1px solid var(--border);
            padding: 16px 24px;
            display: flex;
            align-items: center;
            gap: 20px;
            z-index: 100;
        }

        .progress-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: var(--border);
            border-radius: 100px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-success);
            border-radius: 100px;
            transition: width 0.5s ease;
        }

        .progress-count {
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Footer spacing */
        .footer-space {
            height: 80px;
        }

        /* Architecture Diagram */
        .architecture {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 60px;
        }

        .architecture h2 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .architecture h2::before {
            content: 'â¬¡';
            color: var(--accent-blue);
        }

        .arch-diagram {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 24px;
            overflow-x: auto;
            white-space: pre;
            line-height: 1.5;
            color: var(--text-secondary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 40px 16px;
            }

            .phase-header {
                flex-wrap: wrap;
            }

            .phase-desc {
                margin-left: 0;
                width: 100%;
                margin-top: 8px;
            }

            .progress-section {
                flex-wrap: wrap;
                gap: 12px;
            }

            .progress-label {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="badge">Backend Infrastructure Training</div>
            <h1>Bottleneck Lab</h1>
            <p class="subtitle">ë³‘ëª©ì„ ì§ì ‘ ë§Œë“¤ê³ , ê´€ì°°í•˜ê³ , í•´ê²°í•˜ëŠ” ì‹¤ìŠµ í”„ë¡œì íŠ¸. ì¸ìŠ¤í„´ìŠ¤ í¬ê¸°ë¥¼ í‚¤ìš°ì§€ ì•Šê³  ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë²•ì„ ë°°ìš´ë‹¤.</p>
        </header>

        <section class="overview">
            <div class="overview-card">
                <div class="overview-icon">ğŸ¯</div>
                <h3>í•™ìŠµ ëª©í‘œ</h3>
                <p>DB connection pool, ë©”ëª¨ë¦¬, ë„¤íŠ¸ì›Œí¬ ë ˆë²¨ì˜ ë³‘ëª©ì„ ì¸ìœ„ì ìœ¼ë¡œ ë§Œë“¤ê³  ì§€í‘œë¡œ í™•ì¸í•˜ë©° íŠœë‹í•˜ëŠ” ê²½í—˜</p>
            </div>
            <div class="overview-card">
                <div class="overview-icon">ğŸ› </div>
                <h3>ê¸°ìˆ  ìŠ¤íƒ</h3>
                <p>Go, MySQL, Docker Compose, k6/hey (ë¶€í•˜ í…ŒìŠ¤íŠ¸), Prometheus/Grafana (ì„ íƒ)</p>
            </div>
            <div class="overview-card">
                <div class="overview-icon">â±</div>
                <h3>ì˜ˆìƒ ì†Œìš”</h3>
                <p>Phase 1: 2-3ì‹œê°„ / Phase 2: 3-4ì‹œê°„ / Phase 3: 4-5ì‹œê°„</p>
            </div>
        </section>

        <section class="architecture">
            <h2>ì‹¤ìŠµ ì•„í‚¤í…ì²˜</h2>
            <div class="arch-diagram">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Docker Compose / Local K8s                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚   k6 / hey   â”‚â”€â”€â”€â”€â”€â–¶â”‚     Go Server    â”‚â”€â”€â”€â”€â”€â–¶â”‚    MySQL     â”‚      â”‚
â”‚   â”‚  (ë¶€í•˜ ìƒì„±)  â”‚      â”‚                  â”‚      â”‚              â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚  - 1000ë§Œ row â”‚      â”‚
â”‚                         â”‚  â”‚  /metrics  â”‚  â”‚      â”‚  - ì œí•œëœ connâ”‚      â”‚
â”‚                         â”‚  â”‚  /slow     â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚  /heavy    â”‚  â”‚                            â”‚
â”‚   â”‚   tc/toxiproxyâ”‚      â”‚  â”‚  /leak     â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚ (ë„¤íŠ¸ì›Œí¬ ì¡°ì‘)â”‚â”€ â”€ â”€â–¶â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”€â”€â”€â”€â”€â–¶â”‚  External API â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   (Mock)     â”‚      â”‚
â”‚                                  â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                  â–¼                                       â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚                         â”‚   Grafana    â”‚  (ì„ íƒ)                         â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
        </section>

        <!-- Phase 1 -->
        <section class="phase phase-1">
            <div class="phase-header">
                <div class="phase-number">01</div>
                <h2 class="phase-title">DB Connection Pool ë³‘ëª©</h2>
                <span class="phase-desc">pool exhaustionì„ ì§ì ‘ ê²½í—˜í•˜ê³  í•´ê²°í•œë‹¤</span>
            </div>
            <div class="tasks">
                <div class="task" data-task="1-1">
                    <div class="task-header">
                        <div class="task-checkbox"></div>
                        <div class="task-info">
                            <div class="task-name">
                                í™˜ê²½ êµ¬ì„±
                                <span class="task-tag tag-infra">Infra</span>
                            </div>
                            <div class="task-brief">Docker Composeë¡œ Go ì„œë²„ + MySQL êµ¬ì„±</div>
                        </div>
                        <div class="task-toggle">â–¼</div>
                    </div>
                    <div class="task-content">
                        <div class="task-section">
                            <div class="task-section-title">ëª©í‘œ</div>
                            <p>ê¸°ë³¸ ì‹¤ìŠµ í™˜ê²½ì„ êµ¬ì„±í•˜ê³  connection pool ìƒíƒœë¥¼ ë…¸ì¶œí•˜ëŠ” /metrics ì—”ë“œí¬ì¸íŠ¸ë¥¼ ë§Œë“ ë‹¤.</p>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ì²´í¬ë¦¬ìŠ¤íŠ¸</div>
                            <ul>
                                <li>docker-compose.yml ì‘ì„± (Go app + MySQL)</li>
                                <li>Go ì„œë²„ì— database/sqlë¡œ MySQL ì—°ê²°</li>
                                <li>MaxOpenConnsë¥¼ 5ë¡œ ì„¤ì • (ì¼ë¶€ëŸ¬ ì‘ê²Œ)</li>
                                <li>/metrics ì—”ë“œí¬ì¸íŠ¸ì—ì„œ db.Stats() ë…¸ì¶œ</li>
                                <li>/slow-query ì—”ë“œí¬ì¸íŠ¸ ìƒì„± (SELECT SLEEP(0.1))</li>
                            </ul>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">í™•ì¸ í¬ì¸íŠ¸</div>
                            <div class="code-block">curl localhost:8080/metrics
# ì‘ë‹µ ì˜ˆì‹œ
{
  "db_open_connections": 0,
  "db_in_use": 0,
  "db_idle": 0,
  "db_wait_count": 0
}</div>
                        </div>
                    </div>
                </div>

                <div class="task" data-task="1-2">
                    <div class="task-header">
                        <div class="task-checkbox"></div>
                        <div class="task-info">
                            <div class="task-name">
                                Pool Exhaustion ìœ ë°œ
                                <span class="task-tag tag-db">DB</span>
                            </div>
                            <div class="task-brief">ë™ì‹œ ìš”ì²­ìœ¼ë¡œ connection pool ê³ ê°ˆ ìƒíƒœ ë§Œë“¤ê¸°</div>
                        </div>
                        <div class="task-toggle">â–¼</div>
                    </div>
                    <div class="task-content">
                        <div class="task-section">
                            <div class="task-section-title">ëª©í‘œ</div>
                            <p>5ê°œ connectionìœ¼ë¡œ 100ê°œ ë™ì‹œ ìš”ì²­ì„ ì²˜ë¦¬í•˜ë©´ì„œ wait_countê°€ ì¦ê°€í•˜ëŠ” ê²ƒì„ í™•ì¸í•œë‹¤.</p>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ì‹¤í–‰</div>
                            <div class="code-block"># hey ì„¤ì¹˜ í›„ ì‹¤í–‰
hey -n 1000 -c 100 http://localhost:8080/slow-query

# ë¶€í•˜ ì¤‘ ë‹¤ë¥¸ í„°ë¯¸ë„ì—ì„œ
watch -n 0.5 'curl -s localhost:8080/metrics | jq'</div>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ê´€ì°° í¬ì¸íŠ¸</div>
                            <ul>
                                <li>db_in_useê°€ 5ì—ì„œ ê³ ì •ë˜ëŠ”ì§€</li>
                                <li>db_wait_countê°€ ì¦ê°€í•˜ëŠ”ì§€</li>
                                <li>db_wait_durationì´ ì–¼ë§ˆë‚˜ ìŒ“ì´ëŠ”ì§€</li>
                                <li>hey ê²°ê³¼ì—ì„œ latency ë¶„í¬ í™•ì¸</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="task" data-task="1-3">
                    <div class="task-header">
                        <div class="task-checkbox"></div>
                        <div class="task-info">
                            <div class="task-name">
                                íŠœë‹ ë° ë¹„êµ
                                <span class="task-tag tag-db">DB</span>
                            </div>
                            <div class="task-brief">MaxOpenConnsë¥¼ ì¡°ì ˆí•˜ë©° ì„±ëŠ¥ ë³€í™” ì¸¡ì •</div>
                        </div>
                        <div class="task-toggle">â–¼</div>
                    </div>
                    <div class="task-content">
                        <div class="task-section">
                            <div class="task-section-title">ëª©í‘œ</div>
                            <p>pool í¬ê¸°ì— ë”°ë¥¸ ì„±ëŠ¥ ì°¨ì´ë¥¼ ì§ì ‘ ì¸¡ì •í•˜ê³  ì ì • ê°’ì„ ì°¾ëŠ”ë‹¤.</p>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ì‹¤í—˜</div>
                            <ul>
                                <li>MaxOpenConns: 5 â†’ 10 â†’ 25 â†’ 50ìœ¼ë¡œ ë³€ê²½</li>
                                <li>ê° ì„¤ì •ì—ì„œ ë™ì¼í•œ ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</li>
                                <li>ì‘ë‹µ ì‹œê°„ p50, p95, p99 ë¹„êµ</li>
                                <li>MySQL ì¸¡ thread ìˆ˜ í™•ì¸ (SHOW STATUS LIKE 'Threads_connected')</li>
                            </ul>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">í•™ìŠµ í¬ì¸íŠ¸</div>
                            <p>poolì´ í¬ë‹¤ê³  ë¬´ì¡°ê±´ ì¢‹ì§€ ì•Šë‹¤. MySQL max_connections í•œê³„ì™€ context switching ë¹„ìš©ì„ ê³ ë ¤í•´ì•¼ í•œë‹¤.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Phase 2 -->
        <section class="phase phase-2">
            <div class="phase-header">
                <div class="phase-number">02</div>
                <h2 class="phase-title">ë©”ëª¨ë¦¬ & ëŒ€ìš©ëŸ‰ ë°ì´í„° ë³‘ëª©</h2>
                <span class="phase-desc">OOMê³¼ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ê²½í—˜í•˜ê³  ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ í•´ê²°í•œë‹¤</span>
            </div>
            <div class="tasks">
                <div class="task" data-task="2-1">
                    <div class="task-header">
                        <div class="task-checkbox"></div>
                        <div class="task-info">
                            <div class="task-name">
                                ëŒ€ìš©ëŸ‰ ë°ì´í„° ìƒì„±
                                <span class="task-tag tag-db">DB</span>
                            </div>
                            <div class="task-brief">1000ë§Œ row í…Œì´ë¸” ìƒì„± ë° ë²Œí¬ INSERT</div>
                        </div>
                        <div class="task-toggle">â–¼</div>
                    </div>
                    <div class="task-content">
                        <div class="task-section">
                            <div class="task-section-title">ëª©í‘œ</div>
                            <p>ì‹¤ì œ PoC í™˜ê²½ê³¼ ìœ ì‚¬í•œ ëŒ€ìš©ëŸ‰ í…Œì´ë¸”ì„ ë§Œë“ ë‹¤.</p>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">SQL</div>
                            <div class="code-block">CREATE TABLE sensor_logs (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    sensor_id VARCHAR(50),
    value DECIMAL(10,4),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_sensor_created (sensor_id, created_at)
);

-- í”„ë¡œì‹œì €ë¡œ 1000ë§Œ ê±´ ìƒì„± (ë˜ëŠ” Go ì½”ë“œë¡œ batch insert)</div>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">íŒ</div>
                            <p>ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¬ë©´ 100ë§Œ ê±´ìœ¼ë¡œ ì‹œì‘í•´ë„ ë¨. ë³‘ëª© ìœ ë°œì—ëŠ” ì¶©ë¶„í•˜ë‹¤.</p>
                        </div>
                    </div>
                </div>

                <div class="task" data-task="2-2">
                    <div class="task-header">
                        <div class="task-checkbox"></div>
                        <div class="task-info">
                            <div class="task-name">
                                OOM ìœ ë°œ
                                <span class="task-tag tag-memory">Memory</span>
                            </div>
                            <div class="task-brief">ì „ì²´ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ë©”ëª¨ë¦¬ì— ë¡œë“œí•´ì„œ í„°ëœ¨ë¦¬ê¸°</div>
                        </div>
                        <div class="task-toggle">â–¼</div>
                    </div>
                    <div class="task-content">
                        <div class="task-section">
                            <div class="task-section-title">ëª©í‘œ</div>
                            <p>SELECT * FROM sensor_logs ê²°ê³¼ë¥¼ sliceì— ì „ë¶€ ë‹´ì•„ì„œ OOMì„ ê²½í—˜í•œë‹¤.</p>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ì½”ë“œ ì˜ˆì‹œ</div>
                            <div class="code-block">// ì´ë ‡ê²Œ í•˜ë©´ ì•ˆ ë¨ (ì¼ë¶€ëŸ¬ í„°ëœ¨ë¦¬ê¸°)
func loadAllData(db *sql.DB) ([]SensorLog, error) {
    rows, _ := db.Query("SELECT * FROM sensor_logs")
    var results []SensorLog
    for rows.Next() {
        var log SensorLog
        rows.Scan(&log.ID, &log.SensorID, &log.Value, &log.CreatedAt)
        results = append(results, log) // ë©”ëª¨ë¦¬ ê³„ì† ì¦ê°€
    }
    return results, nil
}</div>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ê´€ì°° í¬ì¸íŠ¸</div>
                            <ul>
                                <li>runtime.MemStatsë¡œ Alloc ì¶”ì´ í™•ì¸</li>
                                <li>docker statsë¡œ ì»¨í…Œì´ë„ˆ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸</li>
                                <li>OOM Killed ë˜ëŠ” ì‹œì  í™•ì¸</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="task" data-task="2-3">
                    <div class="task-header">
                        <div class="task-checkbox"></div>
                        <div class="task-info">
                            <div class="task-name">
                                ìŠ¤íŠ¸ë¦¬ë°/ì²­í¬ ì²˜ë¦¬ë¡œ í•´ê²°
                                <span class="task-tag tag-memory">Memory</span>
                            </div>
                            <div class="task-brief">cursor ê¸°ë°˜ ë˜ëŠ” LIMIT/OFFSETìœ¼ë¡œ ë©”ëª¨ë¦¬ ì•ˆì •í™”</div>
                        </div>
                        <div class="task-toggle">â–¼</div>
                    </div>
                    <div class="task-content">
                        <div class="task-section">
                            <div class="task-section-title">ëª©í‘œ</div>
                            <p>ë™ì¼í•œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ë˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ì¼ì •í•˜ê²Œ ìœ ì§€í•œë‹¤.</p>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ë°©ë²• 1: rows.Next() ìŠ¤íŠ¸ë¦¬ë°</div>
                            <div class="code-block">// row ë‹¨ìœ„ë¡œ ì²˜ë¦¬í•˜ê³  ë²„ë¦¬ê¸°
func processStream(db *sql.DB, handler func(SensorLog)) error {
    rows, _ := db.Query("SELECT * FROM sensor_logs")
    defer rows.Close()
    for rows.Next() {
        var log SensorLog
        rows.Scan(...)
        handler(log) // ì²˜ë¦¬ í›„ ë‹¤ìŒìœ¼ë¡œ
    }
    return nil
}</div>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ë°©ë²• 2: ì²­í¬ ë‹¨ìœ„ ì¡°íšŒ</div>
                            <div class="code-block">// LIMIT/OFFSET ë˜ëŠ” cursor ê¸°ë°˜
func processChunks(db *sql.DB, chunkSize int) {
    lastID := 0
    for {
        rows, _ := db.Query(
            "SELECT * FROM sensor_logs WHERE id > ? ORDER BY id LIMIT ?",
            lastID, chunkSize,
        )
        // ì²­í¬ ì²˜ë¦¬ í›„ lastID ì—…ë°ì´íŠ¸
    }
}</div>
                        </div>
                    </div>
                </div>

                <div class="task" data-task="2-4">
                    <div class="task-header">
                        <div class="task-checkbox"></div>
                        <div class="task-info">
                            <div class="task-name">
                                ê³ ë£¨í‹´ ëˆ„ìˆ˜ ìœ ë°œ ë° í•´ê²°
                                <span class="task-tag tag-memory">Memory</span>
                            </div>
                            <div class="task-brief">ì™„ë£Œë˜ì§€ ì•ŠëŠ” ê³ ë£¨í‹´ìœ¼ë¡œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ê²½í—˜</div>
                        </div>
                        <div class="task-toggle">â–¼</div>
                    </div>
                    <div class="task-content">
                        <div class="task-section">
                            <div class="task-section-title">ëª©í‘œ</div>
                            <p>channelì„ ë‹«ì§€ ì•Šê±°ë‚˜ context ì·¨ì†Œ ì—†ì´ ê³ ë£¨í‹´ì„ ìƒì„±í•´ì„œ ëˆ„ìˆ˜ë¥¼ ë§Œë“ ë‹¤.</p>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ëˆ„ìˆ˜ ì½”ë“œ ì˜ˆì‹œ</div>
                            <div class="code-block">// ìš”ì²­ë§ˆë‹¤ ê³ ë£¨í‹´ ìƒì„±, ì¢…ë£Œ ì¡°ê±´ ì—†ìŒ
func leakyHandler(w http.ResponseWriter, r *http.Request) {
    ch := make(chan int)
    go func() {
        val := <-ch // ì˜ì›íˆ ëŒ€ê¸° (chì— ê°’ ì•ˆ ë³´ëƒ„)
        fmt.Println(val)
    }()
    w.Write([]byte("ok"))
}</div>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ê´€ì°° ë° í•´ê²°</div>
                            <ul>
                                <li>runtime.NumGoroutine() ì¶”ì´ í™•ì¸</li>
                                <li>ìš”ì²­ ë°˜ë³µ ì‹œ ê³ ë£¨í‹´ ìˆ˜ê°€ ê³„ì† ì¦ê°€í•˜ëŠ”ì§€ í™•ì¸</li>
                                <li>context.WithTimeoutìœ¼ë¡œ ê³ ë£¨í‹´ ì¢…ë£Œ ì¡°ê±´ ì¶”ê°€</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Phase 3 -->
        <section class="phase phase-3">
            <div class="phase-header">
                <div class="phase-number">03</div>
                <h2 class="phase-title">ë„¤íŠ¸ì›Œí¬ & ì™¸ë¶€ API ë³‘ëª©</h2>
                <span class="phase-desc">ëŠë¦° ë„¤íŠ¸ì›Œí¬, íƒ€ì„ì•„ì›ƒ, ì¬ì‹œë„ ë¡œì§ì„ ë‹¤ë£¬ë‹¤</span>
            </div>
            <div class="tasks">
                <div class="task" data-task="3-1">
                    <div class="task-header">
                        <div class="task-checkbox"></div>
                        <div class="task-info">
                            <div class="task-name">
                                ë„¤íŠ¸ì›Œí¬ ì§€ì—° ì‹œë®¬ë ˆì´ì…˜
                                <span class="task-tag tag-network">Network</span>
                            </div>
                            <div class="task-brief">tc ë˜ëŠ” toxiproxyë¡œ latency ì£¼ì…</div>
                        </div>
                        <div class="task-toggle">â–¼</div>
                    </div>
                    <div class="task-content">
                        <div class="task-section">
                            <div class="task-section-title">ëª©í‘œ</div>
                            <p>ì™¸ë¶€ API ì‘ë‹µì´ ëŠë¦´ ë•Œ ì„œë²„ê°€ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤.</p>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ë°©ë²• 1: Mock ì„œë²„ì—ì„œ ì§€ì—°</div>
                            <div class="code-block">// ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•
func slowExternalAPI(w http.ResponseWriter, r *http.Request) {
    time.Sleep(3 * time.Second) // 3ì´ˆ ì§€ì—°
    w.Write([]byte(`{"result": "ok"}`))
}</div>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ë°©ë²• 2: Toxiproxy</div>
                            <div class="code-block"># docker-composeì— toxiproxy ì¶”ê°€
toxiproxy-cli create external_api -l 0.0.0.0:8474 -u mock_api:8080
toxiproxy-cli toxic add external_api -t latency -a latency=2000</div>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ê´€ì°° í¬ì¸íŠ¸</div>
                            <ul>
                                <li>ì™¸ë¶€ API í˜¸ì¶œ ì‹œ ê³ ë£¨í‹´ì´ ìŒ“ì´ëŠ”ì§€</li>
                                <li>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¦ê°€ ì¶”ì´</li>
                                <li>ìš”ì²­ timeout ë°œìƒ ì‹œì </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="task" data-task="3-2">
                    <div class="task-header">
                        <div class="task-checkbox"></div>
                        <div class="task-info">
                            <div class="task-name">
                                Timeout ë° Context ì²˜ë¦¬
                                <span class="task-tag tag-network">Network</span>
                            </div>
                            <div class="task-brief">context.WithTimeoutìœ¼ë¡œ ìš”ì²­ ì œì–´</div>
                        </div>
                        <div class="task-toggle">â–¼</div>
                    </div>
                    <div class="task-content">
                        <div class="task-section">
                            <div class="task-section-title">ëª©í‘œ</div>
                            <p>ì™¸ë¶€ APIê°€ ëŠë ¤ë„ ë‚´ ì„œë²„ëŠ” ì¼ì • ì‹œê°„ ë‚´ì— ì‘ë‹µí•˜ë„ë¡ ë§Œë“ ë‹¤.</p>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ì½”ë“œ ì˜ˆì‹œ</div>
                            <div class="code-block">func callExternalWithTimeout(url string) ([]byte, error) {
    ctx, cancel := context.WithTimeout(context.Background(), 2*time.Second)
    defer cancel()
    
    req, _ := http.NewRequestWithContext(ctx, "GET", url, nil)
    resp, err := http.DefaultClient.Do(req)
    if err != nil {
        if ctx.Err() == context.DeadlineExceeded {
            return nil, fmt.Errorf("external API timeout")
        }
        return nil, err
    }
    defer resp.Body.Close()
    return io.ReadAll(resp.Body)
}</div>
                        </div>
                    </div>
                </div>

                <div class="task" data-task="3-3">
                    <div class="task-header">
                        <div class="task-checkbox"></div>
                        <div class="task-info">
                            <div class="task-name">
                                Circuit Breaker êµ¬í˜„
                                <span class="task-tag tag-network">Network</span>
                            </div>
                            <div class="task-brief">ì—°ì† ì‹¤íŒ¨ ì‹œ ìš”ì²­ ì°¨ë‹¨í•˜ëŠ” íŒ¨í„´</div>
                        </div>
                        <div class="task-toggle">â–¼</div>
                    </div>
                    <div class="task-content">
                        <div class="task-section">
                            <div class="task-section-title">ëª©í‘œ</div>
                            <p>ì™¸ë¶€ APIê°€ ì£½ì—ˆì„ ë•Œ ë¬´í•œ ì¬ì‹œë„ë¡œ ë¦¬ì†ŒìŠ¤ ë‚­ë¹„í•˜ì§€ ì•Šë„ë¡ í•œë‹¤.</p>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ìƒíƒœ ì „ì´</div>
                            <div class="code-block">Closed (ì •ìƒ)
   â”‚
   â”‚ ì—°ì† 5íšŒ ì‹¤íŒ¨
   â–¼
 Open (ì°¨ë‹¨) â”€â”€â”€â”€ 30ì´ˆ í›„ â”€â”€â”€â”€â–¶ Half-Open (ì‹œí—˜)
   â–²                               â”‚
   â”‚ ì‹¤íŒ¨                          â”‚ ì„±ê³µ
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                              Closed (ë³µêµ¬)</div>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ë¼ì´ë¸ŒëŸ¬ë¦¬</div>
                            <ul>
                                <li>sony/gobreaker - ê°€ì¥ ë§ì´ ì‚¬ìš©</li>
                                <li>ì§ì ‘ êµ¬í˜„í•´ë³´ëŠ” ê²ƒë„ í•™ìŠµì— ë„ì›€</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="task" data-task="3-4">
                    <div class="task-header">
                        <div class="task-checkbox"></div>
                        <div class="task-info">
                            <div class="task-name">
                                ì™¸ë¶€ ì—°ë™ ë¡œê¹… ì²´ê³„
                                <span class="task-tag tag-infra">Infra</span>
                            </div>
                            <div class="task-brief">ìš”ì²­/ì‘ë‹µ ì „ì²´ ì¶”ì  ê°€ëŠ¥í•œ ë¡œê¹… êµ¬í˜„</div>
                        </div>
                        <div class="task-toggle">â–¼</div>
                    </div>
                    <div class="task-content">
                        <div class="task-section">
                            <div class="task-section-title">ëª©í‘œ</div>
                            <p>PoC ìš”êµ¬ì‚¬í•­ëŒ€ë¡œ ì™¸ë¶€ ì—°ë™ êµ¬ê°„ì— ìì„¸í•œ ë¡œê¹… êµ¬í˜„.</p>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ë¡œê·¸ êµ¬ì¡°</div>
                            <div class="code-block">type ExternalCallLog struct {
    RequestID    string        `json:"request_id"`
    Timestamp    time.Time     `json:"timestamp"`
    Endpoint     string        `json:"endpoint"`
    Method       string        `json:"method"`
    StatusCode   int           `json:"status_code"`
    Latency      time.Duration `json:"latency_ms"`
    Error        string        `json:"error,omitempty"`
    CircuitState string        `json:"circuit_state"`
}</div>
                        </div>
                        <div class="task-section">
                            <div class="task-section-title">ì²´í¬ë¦¬ìŠ¤íŠ¸</div>
                            <ul>
                                <li>ëª¨ë“  ì™¸ë¶€ ìš”ì²­ì— ê³ ìœ  request_id ë¶€ì—¬</li>
                                <li>ìš”ì²­/ì‘ë‹µ ì‹œê°„ ì¸¡ì •</li>
                                <li>ì—ëŸ¬ ë°œìƒ ì‹œ ìƒì„¸ ì •ë³´ ê¸°ë¡</li>
                                <li>Circuit breaker ìƒíƒœ ë³€ê²½ ì‹œ ì•Œë¦¼</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div class="footer-space"></div>
    </div>

    <div class="progress-section">
        <span class="progress-label">ì „ì²´ ì§„í–‰ë¥ </span>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
        <span class="progress-count" id="progressCount">0 / 11</span>
    </div>

    <script>
        // Task expand/collapse
        document.querySelectorAll('.task-header').forEach(header => {
            header.addEventListener('click', (e) => {
                if (e.target.classList.contains('task-checkbox')) return;
                const task = header.closest('.task');
                task.classList.toggle('expanded');
            });
        });

        // Checkbox handling with localStorage
        const STORAGE_KEY = 'bottleneck-lab-progress';
        
        function loadProgress() {
            const saved = localStorage.getItem(STORAGE_KEY);
            return saved ? JSON.parse(saved) : {};
        }
        
        function saveProgress(progress) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(progress));
        }
        
        function updateProgressBar() {
            const total = document.querySelectorAll('.task-checkbox').length;
            const checked = document.querySelectorAll('.task-checkbox.checked').length;
            const percentage = (checked / total) * 100;
            
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('progressCount').textContent = `${checked} / ${total}`;
        }
        
        // Initialize checkboxes
        const progress = loadProgress();
        document.querySelectorAll('.task').forEach(task => {
            const taskId = task.dataset.task;
            const checkbox = task.querySelector('.task-checkbox');
            
            if (progress[taskId]) {
                checkbox.classList.add('checked');
            }
            
            checkbox.addEventListener('click', (e) => {
                e.stopPropagation();
                checkbox.classList.toggle('checked');
                
                const progress = loadProgress();
                if (checkbox.classList.contains('checked')) {
                    progress[taskId] = true;
                } else {
                    delete progress[taskId];
                }
                saveProgress(progress);
                updateProgressBar();
            });
        });
        
        updateProgressBar();
    </script>
</body>
</html>
